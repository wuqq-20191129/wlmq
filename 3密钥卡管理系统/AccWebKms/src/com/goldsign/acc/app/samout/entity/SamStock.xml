<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goldsign.acc.app.samout.mapper.SamStockMapper">
    
    <resultMap type="com.goldsign.acc.app.samout.entity.SamStock" id="rmSamStock">
        
        <result column="sam_type" property="sam_type" /> 
        <result column="logic_no" property="logic_no" /> 
        <result column="phy_no" property="phy_no" /> 
        <result column="print_no" property="print_no" /> 
        <result column="distribute_place" property="distribute_place" /> 
        <result column="produce_type" property="produce_type" /> 
        <result column="stock_state" property="stock_state" /> 
        <result column="is_instock" property="is_instock" /> 
        <result column="is_bad" property="is_bad" /> 
        <result column="remark" property="remark" /> 
        <result column="start_logic_no" property="start_logic_no" /> 
        <result column="end_logic_no" property="end_logic_no" /> 

    </resultMap>
   
    <select id="checkLogicNo"  parameterType="com.goldsign.acc.app.samout.entity.SamStock" resultMap="rmSamStock">
        SELECT logic_no FROM w_acc_tk.w_ic_sam_stock WHERE is_bad = #{is_bad} and is_instock = #{is_instock}
        and produce_type = #{produce_type} and sam_type = #{sam_type} and distribute_place = #{distribute_place}
       
        <if test="start_logic_no != null and start_logic_no !=''" >  
            and substr(logic_no,1,11)) = #{start_logic_no}
            
        </if> 
        <if test="end_logic_no != null and end_logic_no !=''" >  
            and to_number(substr(logic_no,12,5)) >= to_number(#{end_logic_no})
            
        </if> 
        <if test="stock_state != null and stock_state !=''" >  
            and stock_state in('03','05')
        </if> 
        
        order by logic_no
    </select>
    

    
</mapper>

