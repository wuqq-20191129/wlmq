<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goldsign.acc.app.opma.mapper.DevParaVerCurMapper">
    <resultMap type="DevParaVerCur" id="rmDevIdList">
        
        <result column="device_id" property="device_id" /> 
        
    </resultMap>
    
    <resultMap type="DevParaVerCur" id="rmDevParaVerCur">
        <result column="line_id" property="line_id" />
        <result column="station_id" property="station_id" /> 
        <result column="dev_type_id" property="dev_type_id" />
        <result column="device_id" property="device_id" />
        <result column="parm_type_id" property="parm_type_id" />
        <result column="record_flag" property="record_flag" />
        <result column="version_no" property="version_no" />
        <result column="report_date" property="report_date" />
        <result column="remark" property="remark" />
        <result column="is_effect" property="is_effect" />
        <result column="version_new" property="version_new" />
    </resultMap>

    <!--获取设备id-->
    <select id="getDevIdList"  parameterType="DevParaVerCur" resultMap="rmDevIdList">
        select distinct device_id from w_acc_st.w_op_prm_dev_code where record_flag = '0'
        <if test="dev_type_id !=null and dev_type_id !=''">
            and dev_type_id =#{dev_type_id} 
        </if>
        <if test="line_id !=null and line_id !=''">
            and line_id =#{line_id}
        </if>
        <if test="station_id !=null and station_id !=''">
            and station_id =#{station_id}
        </if> 
        order by device_id asc
    </select>
    
    <select id="getDevParaVerCurs" parameterType="java.util.Map" statementType="CALLABLE">
        {
            call W_ACC_ST.W_Up_OP_DEV_CUR_QUER(
                #{record_flag,mode=IN,jdbcType=VARCHAR},#{parm_type_id,mode=IN,jdbcType=VARCHAR},
                #{is_effect,mode=IN,jdbcType=VARCHAR},#{line_id,mode=IN,jdbcType=VARCHAR},
                #{station_id,mode=IN,jdbcType=VARCHAR},#{dev_type_id,mode=IN,jdbcType=VARCHAR},
                #{device_id,mode=IN,jdbcType=VARCHAR},#{genTime,mode=IN,jdbcType=VARCHAR},
                #{endTime,mode=IN,jdbcType=VARCHAR},
                #{result,mode=OUT,jdbcType=CURSOR,javaType=ResultSet, resultMap=rmDevParaVerCur}
            )
        }
    </select>
    
</mapper>
