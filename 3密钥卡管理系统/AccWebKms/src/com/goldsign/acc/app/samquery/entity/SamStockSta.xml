<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goldsign.acc.app.samquery.mapper.SamStockStaMapper">
    <resultMap type="SamStockSta" id="rmSamStockSta">
        <result column="sam_type" property="sam_type" /> 
        <result column="logic_no" property="logic_no" />
        <result column="produce_type" property="produce_type" />
        <result column="is_instock" property="is_instock" />
        <result column="is_bad" property="is_bad" /> 
        <result column="outStockEmptyQty" property="outStockEmptyQty" />
        <result column="stockEmptyQty" property="stockEmptyQty" />
        <result column="outStockProductQty" property="outStockProductQty" />
        <result column="goodStockProductQty" property="goodStockProductQty" />
        <result column="badStockProductQty" property="badStockProductQty" />
    </resultMap>
     
    <select id="getSamStockSta"  parameterType="SamStockSta" resultMap="rmSamStockSta">
        select sam_type,sum(case when PRODUCE_TYPE='00' and IS_INSTOCK = '0'  THEN 1 else 0 end) as outStockEmptyQty,
                        sum(case when PRODUCE_TYPE='00' and IS_INSTOCK = '1'  THEN 1 else 0 end) as stockEmptyQty,
                        sum(case when PRODUCE_TYPE='01' and IS_INSTOCK = '0'  THEN 1 else 0 end) as outStockProductQty,
                        sum(case when PRODUCE_TYPE='01' and IS_INSTOCK = '1' and IS_BAD = '1' THEN 1 else 0 end) as goodStockProductQty,
                        sum(case when PRODUCE_TYPE='01' and IS_INSTOCK = '1' and IS_BAD = '0' THEN 1 else 0 end) as badStockProductQty,
                        sum(case when PRODUCE_TYPE='01' and IS_INSTOCK = '0' and IS_BAD = '2' THEN 1 else 0 end) as outLockStock,
                        sum(case when PRODUCE_TYPE='01' and IS_INSTOCK = '1' and IS_BAD = '2' THEN 1 else 0 end) as inLockStock 
        from  W_ACC_TK.W_IC_SAM_STOCK where 1=1
        <if test="sam_type !=null and sam_type !=''">
            and sam_type =#{sam_type} 
        </if>
        <if test="beginLogicNo !=null and beginLogicNo !=''">
            and logic_no &gt;= #{beginLogicNo} 
        </if>
        <if test="endLogicNo !=null and endLogicNo !=''">
            and logic_no &lt;= #{endLogicNo} 
        </if>
        group by sam_type
        order by sam_type
    </select>
    
</mapper>
