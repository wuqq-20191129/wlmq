<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goldsign.acc.app.system.mapper.ClusterMapper">
    
    <resultMap type="com.goldsign.acc.app.system.entity.Cluster" id="rmCluster">
        
        <result column="STATUS_DATE" property="statusDate" /> 
        <result column="IP" property="ip" /> 
        <result column="RESOURCE_NAME" property="resourceName" /> 
        <result column="NODE_NAME" property="nodeName" /> 
        <result column="STATUS" property="status" /> 
        <result column="STATUS_DESC" property="statusDesc" /> 
        <result column="REMARK" property="remark" /> 
        <result column="NAME" property="name" /> 
        <result column="TYPE" property="type" /> 
        <result column="IP_VALUE" property="ipValue" /> 

    </resultMap>
    
    <select id="queryPlan"  parameterType="com.goldsign.acc.app.system.entity.Cluster" resultMap="rmCluster">
        select A.ip,A.resource_name, A.status_date, A.node_name, A.status, A.status_desc, A.remark,
        B.name,B.type,B.ip_value 
        from w_acc_mn.w_mtr_current_cluster_info A,  w_acc_mn.w_mtr_device_code B 
        where A.ip = B.ip(+) order by ip_value
                
    </select>
    
    <update id="update" parameterType="com.goldsign.acc.app.system.entity.Cluster" >
        update w_acc_mn.w_mtr_current_cluster_info set 
        status_date = to_date( #{statusDate},'yyyy-mm-dd hh24:mi:ss'), node_name= #{nodeName}, status= #{status}, status_desc= #{statusDesc}, remark= #{remark} 
        where ip= #{ip} and resource_name= #{resourceName}
    </update>
    
    <insert id="insertIntoCur" parameterType="com.goldsign.acc.app.system.entity.Cluster" >
        insert into w_acc_mn.w_mtr_current_cluster_info
        (ip,resource_name,status_date,node_name,status,status_desc,remark) 
        values( #{ip}, #{resourceName}, to_date( #{statusDate},'yyyy-mm-dd hh24:mi:ss'), #{nodeName}, #{status}, #{statusDesc}, #{remark} )
    </insert>
    
    <insert id="insertIntoHis" parameterType="com.goldsign.acc.app.system.entity.Cluster" >
        insert into w_acc_mn.w_mtr_his_cluster_info
        (ip,resource_name,status_date,node_name,status,status_desc,remark) 
        values( #{ip}, #{resourceName}, to_date( #{statusDate},'yyyy-mm-dd hh24:mi:ss'), #{nodeName}, #{status}, #{statusDesc}, #{remark} )
    </insert>
    
</mapper>



