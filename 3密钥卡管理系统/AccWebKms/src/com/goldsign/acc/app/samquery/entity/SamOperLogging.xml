<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goldsign.acc.app.samquery.mapper.SamOperLoggingMapper">
    <resultMap type="SamOperLogging" id="rmSamOperLogging">
        
        <result column="operator_id" property="operatorId" />
        <result column="op_time" property="opTime" />
        <result column="oper_type" property="operType" />
        <result column="description" property="description" />
        <result column="sys_type" property="sysType" />
        <result column="module_id" property="moduleId" />

    </resultMap>
    
    <resultMap type="SamOperLogging" id="rmSamOperLoggingOperType">
        <result column="oper_type" property="operType" />
    </resultMap>
    
    <resultMap type="SamOperLogging" id="rmSamOperLoggingSysType">
        <result column="sys_type" property="sysType" />
    </resultMap>
    
    <select id="getSamOperLoggingOperType" resultMap="rmSamOperLoggingOperType"> 
        select distinct(oper_type) operType from W_ACC_TK.W_IC_SAM_OPER_LOGGING       
    </select>
    
    <select id="getSamOperLoggingSysType" resultMap="rmSamOperLoggingSysType"> 
        select distinct(sys_type) sysType from W_ACC_TK.W_IC_SAM_OPER_LOGGING       
    </select>
    
    <select id="getSamOperLogging"  parameterType="SamOperLogging" resultMap="rmSamOperLogging">
        select OPERATOR_ID,OP_TIME,OPER_TYPE,DESCRIPTION,SYS_TYPE,MODULE_ID from W_ACC_TK.W_IC_SAM_OPER_LOGGING where 1=1 

        <if test="operatorId != null and  operatorId !=''"> 
            and OPERATOR_ID like '${operatorId}%'
        </if>
        <if test="operType != null and operType != ''"> 
            and OPER_TYPE like '${operType}%'
        </if>
        <if test="beginOpTime != null and beginOpTime !=''"> 
            and OP_TIME &gt;= to_date(#{beginOpTime},'yyyy-MM-dd hh24:mi:ss')
        </if>
        <if test="endOpTime != null and endOpTime !=''"> 
            and OP_TIME &lt;= to_date(#{endOpTime},'yyyy-MM-dd hh24:mi:ss')
        </if>
        <if test="sysType != null and sysType !=''"> 
            and SYS_TYPE = #{sysType}
        </if>
        order by OP_TIME desc
    </select>
    
    <select id="getModuleName" parameterType="SamOperLogging" resultType="String">
        select module_name from w_acc_st.W_OP_SYS_MODULE 
        where module_id = #{moduleId} 
    </select>
    
</mapper>
